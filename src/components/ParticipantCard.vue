<template>
  <div class="participant">
    <img
      class="participant-image"
      :src="details.image"
      @dblclick="participants.remove(username)"
    />
    <p>Name: {{ username }}</p>
    <div class="participant-tickets">
      <p class="participant-ticket-count">
        Tickets: {{ details.ticket_count }}
      </p>
      <div class="ticket-buttons">
        <button class="ticket-button increment" @click="addTicket(username)">
          +
        </button>
        <button class="ticket-button decrement" @click="removeTicket(username)">
          -
        </button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { participants } from "@/state/participants";
import { defineProps } from "vue";
const props = defineProps(["username", "details"]);
const addTicket = (key) => {
  console.log(!(props.username in participants.changed));
  if (!(props.username in participants.changed)) {
    participants.changed[props.username] = { ...props.details };
  }
  participants.increment(key);
};

const removeTicket = (key) => {
  if (!(props.username in participants.changed)) {
    participants.changed[props.username] = { ...props.details };
  }
  participants.decrement(key);
};
</script>
